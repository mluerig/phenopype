<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Example 8: Extracting shape features from fossil teeth of cichlids &#8212; phenopype 2.0.1 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Example 7: Measuring worm length" href="example_7_worm_length.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          phenopype</a>
        <span class="navbar-text navbar-version pull-left"><b>2.0.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="https://github.com/mluerig/phenopype">Phenopype on Github</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Additional resources</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="tutorial_0.html">How to run tutorials and examples using Jupyter Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_1_python_intro.html">Tutorial 1: A (very) brief python introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_2_phenopype_images.html">Tutorial 2: Interacting with images in phenopype</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_3_phenopype_workflows.html">Tutorial 3: Image analysis workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_4_managing_projects.html">Tutorial 4: Setting up and managing projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_5_references.html">Tutorial 5: Creating and detecting a reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_6_video_analysis.html">Tutorial 6: Video analysis</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Example 8: Extracting shape features from fossil teeth of cichlids</a></li>
<li><a class="reference internal" href="#Single-tooth-case">Single tooth case</a><ul>
<li><a class="reference internal" href="#High-throughput">High throughput</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Multiple-teeth">Multiple teeth</a><ul>
<li><a class="reference internal" href="#id1">High throughput</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="example_7_worm_length.html" title="Previous Chapter: Example 7: Measuring worm length"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Example 7: Me...</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="_sources/example_8_cichlid_teeth.ipynb.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Example 8: Extracting shape features from fossil teeth of cichlids</a></li>
<li><a class="reference internal" href="#Single-tooth-case">Single tooth case</a><ul>
<li><a class="reference internal" href="#High-throughput">High throughput</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Multiple-teeth">Multiple teeth</a><ul>
<li><a class="reference internal" href="#id1">High throughput</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Example-8:-Extracting-shape-features-from-fossil-teeth-of-cichlids">
<h1>Example 8: Extracting shape features from fossil teeth of cichlids<a class="headerlink" href="#Example-8:-Extracting-shape-features-from-fossil-teeth-of-cichlids" title="Permalink to this headline">¶</a></h1>
<p>This example demonstrates how basic and complex features of tooth-shapes are extracted from images containing single and multiple microscope images. Two separate phenopype projects are used for better organization (single tooth and multiple tooth per images). All images are kindly provided by Ole Seehausen.</p>
<center><div style="width:600px; text-align: left"><p><img alt="Cichlid jaw" src="_images/ex8_jaw.jpg" /> <strong>Fig. 1</strong> - Teeth of haplochromine cichlids, still attached to the jaw.</p>
</div></center></div>
<div class="section" id="Single-tooth-case">
<h1>Single tooth case<a class="headerlink" href="#Single-tooth-case" title="Permalink to this headline">¶</a></h1>
<p>These are single-tooth images where the background is brighter than the teeth, and also quite noisy. The challenges here lie in preventing unwanted objects from being detected (e.g. the checkered paper). In this case, the easiest way is to draw a rectangle mask around the object. Furthermore, the scale bar needs to be measured in every image because it varies in size between images. This is because the microscope software returns non-standardized scale bars that vary between images.</p>
<div class="row; text-align: left"><div class="col-md-6"><p><img alt="Before - single tooth case" src="_images/ex8_before1.jpg" /></p>
</div><div class="col-md-6"><p><img alt="After - single tooth case" src="_images/ex8_after1.jpg" /></p>
</div><p><strong>Fig. 2</strong> - single tooth, removed from the jaw.</p>
</div><div class="section" id="High-throughput">
<h2>High throughput<a class="headerlink" href="#High-throughput" title="Permalink to this headline">¶</a></h2>
<p>First we need to specify two directory: the root directory of the project (for example, nested within your project folder - see <a class="reference external" href="https://mluerig.github.io/phenopype/api.html#projects">https://mluerig.github.io/phenopype/api.html#projects</a>) and the path to the image folder.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">phenopype</span> <span class="k">as</span> <span class="nn">pp</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">root</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;_temp/output/ex8_single&quot;</span> <span class="c1">## this is the path to a (new) folder inside your project directory</span>
<span class="n">images</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;images&quot;</span>
</pre></div>
</div>
</div>
<p>Project creation follows the usual procedure (see <a class="reference internal" href="tutorial_3_phenopype_workflows.html#High-throughput-worflow"><span class="std std-ref">Tutorial 3</span></a>, <a class="reference internal" href="tutorial_4_managing_projects.html"><span class="doc">Tutorial 4</span></a>, or <a class="reference external" href="https://mluerig.github.io/phenopype/example_2_landmarks_stickleback.html#High-throughput">Example 2</a> and <a class="reference external" href="example_6_counting_snails.html#High-throughput">Example 6</a>): first we create the project at the root folder location, then we add the images (with “link” so the files don’t get copied - read about the
differences between the two modes in the <a class="reference external" href="api.html#phenopype.main.project.add_files">API</a>), add pype-configuration files (the template for this part is “ex8_1”), and save the project object.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">proj</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">root_dir</span><span class="o">=</span><span class="n">root</span><span class="p">)</span>
<span class="n">proj</span><span class="o">.</span><span class="n">add_files</span><span class="p">(</span><span class="n">image_dir</span><span class="o">=</span><span class="n">images</span><span class="p">,</span> <span class="n">search_mode</span><span class="o">=</span><span class="s2">&quot;recursive&quot;</span><span class="p">,</span> <span class="n">raw_mode</span><span class="o">=</span><span class="s2">&quot;link&quot;</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cichlid&quot;</span><span class="p">],</span> <span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;multi&quot;</span><span class="p">])</span>
<span class="n">proj</span><span class="o">.</span><span class="n">add_config</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;v1&quot;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="s2">&quot;ex8_1&quot;</span><span class="p">)</span>
<span class="n">pp</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">proj</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
--------------------------------------------
Phenopype will create a new project at
D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single

Proceed? (y/n)
y
Warning - project root_dir already exists - overwrite? (y/n)y

&#34;D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single&#34; created (overwritten)

project attributes written to D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single\attributes.yaml
--------------------------------------------
--------------------------------------------
phenopype will search for image files at

D:\workspace\git\phenopype\tutorials\images

using the following settings:

filetypes: [&#39;jpg&#39;, &#39;JPG&#39;, &#39;jpeg&#39;, &#39;JPEG&#39;, &#39;tif&#39;, &#39;png&#39;, &#39;bmp&#39;], include: [&#39;cichlid&#39;], exclude: [&#39;multi&#39;], mode: copy, recursive: False, resize: False, unique: path

Found image cichlid1.jpg - phenopype-project folder 0__cichlid1 created
Found image cichlid2.jpg - phenopype-project folder 0__cichlid2 created
Found image cichlid3.jpg - phenopype-project folder 0__cichlid3 created

Found 3 files
--------------------------------------------
New pype configuration created (ex8_1.yaml) from phenopype template:
d:\workspace\git\phenopype\phenopype\templates\ex8_1.yaml
pype_v1.yaml created for 0__cichlid1
pype_v1.yaml created for 0__cichlid2
pype_v1.yaml created for 0__cichlid3
Project data saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single\project.data.
</pre></div></div>
</div>
<p>Alternatively, if you have already created a project, load it:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">proj</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
--------------------------------------------
Project loaded from
D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single

Project has 3 image folders
--------------------------------------------
</pre></div></div>
</div>
<p>Now we can process the loaded images in a simple <code class="docutils literal notranslate"><span class="pre">for</span></code> loop. <strong>This is the central step in the analysis, so refer to the above mentioned tutorials and examples if you are unsure how this procedure works.</strong> Briefly said, phenopype will process all the information provided with the config files, show you the result, and wait for your input. If you are happy with the result, then hit <code class="docutils literal notranslate"><span class="pre">Enter</span></code> after the the script has run (as indicated in the Python console), or change the parameters (e.g. the
thresholding value or the contour size cutoff) until your results are satisfying. Here is an example-animation (using a different image, but the principle is the same) for two of the involved tools: <code class="docutils literal notranslate"><span class="pre">create_mask</span></code> and <code class="docutils literal notranslate"><span class="pre">create_reference</span></code> (See <a class="reference internal" href="tutorial_4_managing_projects.html"><span class="doc">Tutorial 4</span></a> and <a class="reference internal" href="example_1_detect_objects_isopods.html#Drawing-a-mask"><span class="std std-ref">Example 1</span></a>):</p>
<center><div style="width:500px; text-align: left"><p><img alt="Example: create scale" src="_images/masks1.gif" /></p>
<p><strong>Mask creation</strong> - Drag a rectangle across the image and hit enter. The dection algorithims will then only operate within this ROI.</p>
<p><img alt="Example: mask tool" src="_images/ex1_scale.gif" /></p>
<p><strong>Scale measurement</strong> - Drag a line along the scale bar and hit enter. Then enter the measured distance in mm and hit enter. This will include pixel-to-mm information, which we want for every image. In this example, you don’t need to do the third step (template/mask creation).</p>
</div></center><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">dirpath</span> <span class="ow">in</span> <span class="n">proj</span><span class="o">.</span><span class="n">dirpaths</span><span class="p">:</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">pype</span><span class="p">(</span><span class="n">dirpath</span><span class="p">,</span>
                 <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v1&quot;</span><span class="p">,</span>      <span class="c1">## note that this is the name we gave our configuration file.</span>
                                 <span class="c1">## with this you can specify multiple configurations side by side, e.g. if you</span>
                                 <span class="c1">## want to re-run some of the analysis, but don&#39;t want overwrite your past attempts</span>
                 <span class="n">skip</span><span class="o">=</span><span class="kc">True</span>       <span class="c1">## this will skip image-folders that already have results in them</span>
                <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Succesfully loaded existing pype config (pype_config_v1.yaml) from:
D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single\data\0__cichlid1\pype_config_v1.yaml


------------+++ new pype iteration 2021:05:10 16:20:32 +++--------------


Nothing loaded.
PREPROCESSING
create_mask
- creating mask
create_reference
- measure pixel-to-mm-ratio
Reference set
- add column length
SEGMENTATION
blur
threshold
- including pixels from 1 drawn masks
morphology
find_contours
- found 1 contours that match criteria
MEASUREMENT
shape_features
VISUALIZATION
select_canvas
- red channel
draw_contours
=== AUTOSAVE ===
save_canvas
- canvas saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single\data\0__cichlid1\canvas_v1.jpg.
save_contours
- contours saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single\data\0__cichlid1\contours_v1.csv.
save_masks
- masks saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single\data\0__cichlid1\masks_v1.csv.
save_shapes
- shapes saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single\data\0__cichlid1\shapes_v1.csv.


------------+++ finished pype iteration +++--------------
-------(End with Ctrl+Enter or re-run with Enter)--------




TERMINATE
Succesfully loaded existing pype config (pype_config_v1.yaml) from:
D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single\data\0__cichlid2\pype_config_v1.yaml


------------+++ new pype iteration 2021:05:10 16:20:48 +++--------------


Nothing loaded.
PREPROCESSING
create_mask
- creating mask
create_reference
- measure pixel-to-mm-ratio
Reference set
- add column length
SEGMENTATION
blur
threshold
- including pixels from 1 drawn masks
morphology
find_contours
- found 1 contours that match criteria
MEASUREMENT
shape_features
VISUALIZATION
select_canvas
- red channel
draw_contours
=== AUTOSAVE ===
save_canvas
- canvas saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single\data\0__cichlid2\canvas_v1.jpg.
save_contours
- contours saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single\data\0__cichlid2\contours_v1.csv.
save_masks
- masks saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single\data\0__cichlid2\masks_v1.csv.
save_shapes
- shapes saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single\data\0__cichlid2\shapes_v1.csv.


------------+++ finished pype iteration +++--------------
-------(End with Ctrl+Enter or re-run with Enter)--------




TERMINATE
Succesfully loaded existing pype config (pype_config_v1.yaml) from:
D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single\data\0__cichlid3\pype_config_v1.yaml


------------+++ new pype iteration 2021:05:10 16:21:03 +++--------------


Nothing loaded.
PREPROCESSING
create_mask
- creating mask
create_reference
- measure pixel-to-mm-ratio
Reference set
- add column length
SEGMENTATION
blur
threshold
- including pixels from 1 drawn masks
morphology
find_contours
- found 1 contours that match criteria
MEASUREMENT
shape_features
VISUALIZATION
select_canvas
- red channel
draw_contours
=== AUTOSAVE ===
save_canvas
- canvas saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single\data\0__cichlid3\canvas_v1.jpg.
save_contours
- contours saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single\data\0__cichlid3\contours_v1.csv.
save_masks
- masks saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single\data\0__cichlid3\masks_v1.csv.
save_shapes
- shapes saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single\data\0__cichlid3\shapes_v1.csv.


------------+++ finished pype iteration +++--------------
-------(End with Ctrl+Enter or re-run with Enter)--------




TERMINATE
</pre></div></div>
</div>
<p>After we completed the loop, use the <code class="docutils literal notranslate"><span class="pre">collect_results</span></code> method of <code class="docutils literal notranslate"><span class="pre">proj</span></code> to save all results to a folder in the root directory.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">proj</span><span class="o">.</span><span class="n">collect_results</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;v1&quot;</span><span class="p">,</span>
                     <span class="n">files</span><span class="o">=</span><span class="s2">&quot;shapes&quot;</span><span class="p">,</span>
                     <span class="n">folder</span><span class="o">=</span><span class="s2">&quot;shape_features&quot;</span><span class="p">,</span>
                     <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Created D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single\shape_features
[&#39;shapes_v1&#39;]
Collected shapes_v1.csv from 0__cichlid1
0__cichlid1_shapes_v1.csv saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single\shape_features\0__cichlid1_shapes_v1.csv.
Collected shapes_v1.csv from 0__cichlid2
0__cichlid2_shapes_v1.csv saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single\shape_features\0__cichlid2_shapes_v1.csv.
Collected shapes_v1.csv from 0__cichlid3
0__cichlid3_shapes_v1.csv saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_single\shape_features\0__cichlid3_shapes_v1.csv.
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Multiple-teeth">
<h1>Multiple teeth<a class="headerlink" href="#Multiple-teeth" title="Permalink to this headline">¶</a></h1>
<p>Now we will implement the same procedure for the images with multiple teeth, which require only a slightly altered configuration.</p>
<div class="row; text-align: left"><div class="col-md-6"><p><img alt="Before" src="_images/ex8_before2.jpg" /></p>
</div><div class="col-md-6"><p><img alt="After" src="_images/ex8_after2.jpg" /></p>
</div></div></div><div class="section" id="id1">
<h2>High throughput<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p><strong>Before running this part, restart the Kernel to reset the working-directory position.</strong></p>
<p>Again, we need to specify the paths, and create the project.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">phenopype</span> <span class="k">as</span> <span class="nn">pp</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">root</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;_temp/output/ex8_multiple&quot;</span> <span class="c1">## this is the path to a (new) folder inside your project directory</span>
<span class="n">images</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;images&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">proj</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">root_dir</span><span class="o">=</span><span class="n">root</span><span class="p">)</span>
<span class="n">proj</span><span class="o">.</span><span class="n">add_files</span><span class="p">(</span><span class="n">image_dir</span><span class="o">=</span><span class="n">images</span><span class="p">,</span>
               <span class="n">search_mode</span><span class="o">=</span><span class="s2">&quot;recursive&quot;</span><span class="p">,</span>
               <span class="n">raw_mode</span><span class="o">=</span><span class="s2">&quot;link&quot;</span><span class="p">,</span>
               <span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cichlid_multi&quot;</span><span class="p">])</span>
<span class="n">proj</span><span class="o">.</span><span class="n">add_config</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;v1&quot;</span><span class="p">,</span>
                <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">template</span><span class="o">=</span><span class="s2">&quot;ex8_2&quot;</span><span class="p">)</span>
<span class="n">pp</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">proj</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
--------------------------------------------
Phenopype will create a new project at
D:\workspace\git\phenopype\tutorials\_temp\output\ex8_multiple

Proceed? (y/n)
y
Warning - project root_dir already exists - overwrite? (y/n)y

&#34;D:\workspace\git\phenopype\tutorials\_temp\output\ex8_multiple&#34; created (overwritten)

project attributes written to D:\workspace\git\phenopype\tutorials\_temp\output\ex8_multiple\attributes.yaml
--------------------------------------------
--------------------------------------------
phenopype will search for image files at

D:\workspace\git\phenopype\tutorials\images

using the following settings:

filetypes: [&#39;jpg&#39;, &#39;JPG&#39;, &#39;jpeg&#39;, &#39;JPEG&#39;, &#39;tif&#39;, &#39;png&#39;, &#39;bmp&#39;], include: [&#39;cichlid_multi&#39;], exclude: [], mode: copy, recursive: False, resize: False, unique: path

Found image cichlid_multi1.jpg - phenopype-project folder 0__cichlid_multi1 created
Found image cichlid_multi2.jpg - phenopype-project folder 0__cichlid_multi2 created
Found image cichlid_multi3.jpg - phenopype-project folder 0__cichlid_multi3 created

Found 3 files
--------------------------------------------
New pype configuration created (ex8_2.yaml) from phenopype template:
d:\workspace\git\phenopype\phenopype\templates\ex8_2.yaml
pype_v1.yaml created for 0__cichlid_multi1
pype_v1.yaml created for 0__cichlid_multi2
pype_v1.yaml created for 0__cichlid_multi3
Project data saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_multiple\project.data.
</pre></div></div>
</div>
<p>Note that here you need to perform an extra step after specifying the scale: since we did not use a mask that excludes unwanted noise (as in the single tooth part above), we need to manually exclude the little scale bar in the bottom corner. Therefore, in the example template <code class="docutils literal notranslate"><span class="pre">&quot;ex8_2&quot;</span></code>, the <code class="docutils literal notranslate"><span class="pre">mask</span></code> argument is already specified. After typing in the distance in mm, you need to drag a rectangle across the mask - (no need to stop the cursor at the edges of the window, just drag it beyond).</p>
<p>Now you can loop through all directories stored within the project object to detect the snails.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">proj</span><span class="o">.</span><span class="n">dirpaths</span><span class="p">:</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">pype</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Succesfully loaded existing pype config (pype_config_v1.yaml) from:
D:\workspace\git\phenopype\tutorials\_temp\output\ex8_multiple\data\0__cichlid_multi1\pype_config_v1.yaml


------------+++ new pype iteration 2021:05:10 16:21:51 +++--------------


Nothing loaded.
PREPROCESSING
create_reference
- measure pixel-to-mm-ratio
Reference set
- add column length
Template selected
SEGMENTATION
blur
threshold
- excluding pixels from 1 drawn masks
morphology
find_contours
- found 37 contours that match criteria
MEASUREMENT
shape_features
VISUALIZATION
select_canvas
- red channel
draw_contours
=== AUTOSAVE ===
save_canvas
- canvas saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_multiple\data\0__cichlid_multi1\canvas_v1.jpg.
save_contours
- contours saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_multiple\data\0__cichlid_multi1\contours_v1.csv.
save_masks
- masks saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_multiple\data\0__cichlid_multi1\masks_v1.csv.
save_shapes
- shapes saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_multiple\data\0__cichlid_multi1\shapes_v1.csv.


------------+++ finished pype iteration +++--------------
-------(End with Ctrl+Enter or re-run with Enter)--------




------------+++ new pype iteration 2021:05:10 16:22:08 +++--------------


Nothing loaded.
PREPROCESSING
create_reference
- measure pixel-to-mm-ratio
Reference set
- add column length
Template selected
- reference template mask already created (overwrite=False)
SEGMENTATION
blur
threshold
- excluding pixels from 1 drawn masks
morphology
find_contours
- found 37 contours that match criteria
MEASUREMENT
shape_features
VISUALIZATION
select_canvas
- red channel
draw_contours
=== AUTOSAVE ===
save_canvas
- canvas saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_multiple\data\0__cichlid_multi1\canvas_v1.jpg (overwritten).
save_contours
- contours saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_multiple\data\0__cichlid_multi1\contours_v1.csv (overwritten).
save_masks
- masks saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_multiple\data\0__cichlid_multi1\masks_v1.csv (overwritten).
save_shapes
- shapes saved under D:\workspace\git\phenopype\tutorials\_temp\output\ex8_multiple\data\0__cichlid_multi1\shapes_v1.csv (overwritten).


------------+++ finished pype iteration +++--------------
-------(End with Ctrl+Enter or re-run with Enter)--------




TERMINATE
Succesfully loaded existing pype config (pype_config_v1.yaml) from:
D:\workspace\git\phenopype\tutorials\_temp\output\ex8_multiple\data\0__cichlid_multi2\pype_config_v1.yaml


------------+++ new pype iteration 2021:05:10 16:22:23 +++--------------


Nothing loaded.
PREPROCESSING
create_reference
- measure pixel-to-mm-ratio
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
An exception has occurred, use %tb to see the full traceback.

<span class="ansi-red-intense-fg ansi-bold">SystemExit</span><span class="ansi-red-intense-fg ansi-bold">:</span>

TERMINATE (by user)

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING: To exit: use &#39;exit&#39;, &#39;quit&#39;, or Ctrl-D.
</pre></div></div>
</div>
<p>In the end, use the <code class="docutils literal notranslate"><span class="pre">collect_results</span></code> method of <code class="docutils literal notranslate"><span class="pre">proj</span></code> to save all results to a folder in the root directory.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">proj</span><span class="o">.</span><span class="n">collect_results</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;v1&quot;</span><span class="p">,</span>
                     <span class="n">files</span><span class="o">=</span><span class="s2">&quot;shapes&quot;</span><span class="p">,</span>
                     <span class="n">folder</span><span class="o">=</span><span class="s2">&quot;shape_features&quot;</span><span class="p">,</span>
                     <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2021, Moritz Lürig.<br/>
      Last updated on May 10, 2021, 5:17:54 PM.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.4.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>